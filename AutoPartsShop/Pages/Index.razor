@page "/"
@using AutoPartsShop.Domain.Dtos
@using AutoPartsShop.Services

@inject NavigationManager NavigationManager
@inject CategoryService CategoryService
@inject ProductService ProductService

<PageTitle>汽修配件商城</PageTitle>

<!-- 轮播图 -->
<Carousel Autoplay="TimeSpan.FromSeconds(5)" DotPosition="CarouselDotPosition.Bottom" Class="carousel">
	@foreach (var banner in banners)
	{
		<CarouselSlick>
			<div class="carousel-item" style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('@banner.ImageUrl')">
				<div class="carousel-content">
					<h2>@banner.Title</h2>
					<p>@banner.Description</p>
					<Button Type="ButtonType.Primary" Size="ButtonSize.Large" OnClick="() => NavigationManager.NavigateTo(banner.Link)">
						立即选购
					</Button>
				</div>
			</div>
		</CarouselSlick>
	}
</Carousel>
<!-- 分类区域 -->
<div class="category-section">
	<Title Level="2">配件分类</Title>
	<GridRow Gutter="16">
		@foreach (var category in categories)
		{
			<GridCol Xs="12" Sm="8" Md="6" Lg="4" Xl="4" Style="margin-bottom: 16px;">
				<Card Class="category-card" Bordered="false">
					<div class="category-content" onclick="@(() => NavigateToCategory(category.Id))">
						<div class="category-name">@category.Name</div>
						<div class="category-des">@category.Description</div>
					</div>
				</Card>
			</GridCol>
		}
	</GridRow>
</div>
<!-- 热门商品 -->
<div class="products-section">
	<Title Level="2">热门商品</Title>
	<GridRow Gutter="16">
		@foreach (var product in hotProducts)
		{
			<GridCol Xs="24" Sm="12" Md="12" Lg="6" Xl="6" Style="margin-bottom: 16px;">
				<Card Class="product-card" Bordered Cover="coverTemplate">
					<ChildContent>
						<CardMeta Title="@product.Name" Description="@($"¥ {product.Price:F2}")" />
					</ChildContent>
					<ActionTemplate>
						<CardAction>
							<Button Type="ButtonType.Primary" OnClick="()=> AddToCart(product)">
								<Icon Type="shopping-cart" />
								加入购物车
							</Button>
						</CardAction>
						<CardAction>
							<Button OnClick="()=> ViewProductDetails(product.Id)">
								<Icon Type="eye" />
								查看详情
							</Button>
						</CardAction>
					</ActionTemplate>
				</Card>
			</GridCol>

		}
	</GridRow>
</div>
<!-- 促销区域 -->
<div class="promotion-section">
	<Card Class="promotion-banner" Bordered="false">
		<Row Gutter="16" Type="flex" Justify="RowJustify.SpaceBetween" Align="RowAlign.Middle">
			<Col Span="16">
			<Title Level="3" Style="color: white;">618大促狂欢节</Title>
			<p Style="color: white; font-size: 16px; margin-bottom: 15px;">全场配件满500减100，多买多优惠！</p>
			<Button Type="default" Size="ButtonSize.Large" OnClick="ShowPromotionDetails" Style="background: white; color: #ff4d4f; font-weight: bold;">
				立即抢购
			</Button>
			</Col>
			<Col Span="8" Style="text-align: center;">
			<Icon Type="gift" Theme="IconThemeType.Fill" Style="font-size: 100px; color: white; opacity: 0.8;" />
			</Col>
		</Row>
	</Card>
</div>



@code {
	private List<CategoryDto> categories = new List<CategoryDto>();
	private List<ProductDto> hotProducts = new List<ProductDto>();

	protected override async Task OnInitializedAsync()
	{
		//获取分类数据
		categories = await CategoryService.GetCategoriesAsync();
		//获取热门商品数据
		hotProducts = await ProductService.GetHotProductsAsync(6);
	}
	private class Banner
	{
		public string ImageUrl { get; set; }
		public string Title { get; set; }
		public string Description { get; set; }
		public string Link { get; set; }
	}
	private List<Banner> banners = new List<Banner>
		{
		new Banner
		{
			ImageUrl = "https://picsum.photos/1920/400",
			Title = "高品质汽修配件",
			Description = "为您的爱车提供最优质的零部件",
			Link = "/products"
		},
		new Banner
		{
			ImageUrl = "https://picsum.photos/1920/400?2",
			Title = "专业服务团队",
			Description = "我们致力于为您提供卓越的客户服务",
			Link = "/services"
		},
		new Banner
		{
			ImageUrl = "https://picsum.photos/1920/400?3",
			Title = "优惠活动不断",
			Description = "关注我们的最新促销活动，享受更多优惠",
			Link = "/promotions"
		}
		};
	RenderFragment coverTemplate =@<img alt="example" src="https://gw.alipayobjects.com/zos/rmsportal/JiqGstEfoWAOHiTxclqi.png" />;


	private void NavigateToCategory(int categoryId)
	{
		NavigationManager.NavigateTo($"/products/category/{categoryId}");
	}
	private void AddToCart(ProductDto productDto)
	{
	}

	private void ViewProductDetails(int productId)
	{
		NavigationManager.NavigateTo($"/product/{productId}");
	}

	private void ShowPromotionDetails()
	{

	}

}